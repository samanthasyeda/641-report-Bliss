% $Id$

\usepackage{relsize}
\usepackage[T1]{fontenc}
\usepackage{times}
\usepackage{url}
\usepackage{amsmath}
\usepackage{fancyvrb}
\usepackage{colortbl}
\usepackage{mathpartir}
\usepackage{amssymb}
\usepackage{xspace}
\usepackage{comment}
\usepackage{graphicx}
% Added listing for code listings
\usepackage{listings}

% formatting for grammars
\input{obey}
\input{grammar}
\renewcommand{\nonterm}[1]{\mbox{\textit{#1}}}
\newcommand{\oneormore}[1]{#1\ensuremath{^+}}

% Operational semantics (from Curt)
\newcommand{\mc}[1]{\mbox{\rm \ensuremath{\text{\code{#1}}}}} % Arg set in code font in math
\newcommand{\loc}{\ensuremath{\mathord{\mathit{loc}}}}
\newcommand{\handler}[3]{\ensuremath{\langle#1,#2,#3\rangle}}
\newcommand{\ec}{\ensuremath{\mathop{\mathbb{E}}}}
\newcommand{\hole}{\ensuremath{\mathord{\mathit{-}}}}
\newcommand{\reducesto}{\hookrightarrow}
\newcommand{\reducestostar}{\overset{*}{\reducesto}}
\newcommand{\dontcare}{\ensuremath{\mathord{\text{\textvisiblespace\hspace{0.10ex}}}}}
\newcommand{\Expression}{\ensuremath{{\cal E}}}
\newcommand{\Stack}{\mbox{\textit{Stack}}}
\newcommand{\Store}{\mbox{\textit{Store}}}
\newcommand{\ActiveList}{\mbox{\textit{ActiveList}}}
\newcommand{\Frame}{\mbox{\textit{Frame}}}
\newcommand{\FieldEnv}{\mbox{\textit{FieldEnv}}}
\newcommand{\ObjectRecord}{\mbox{\textit{ObjectRecord}}}
\newcommand{\lexframe}{\mbox{\textbf{\texttt{lexframe}}}}
\newcommand{\evframe}{\mbox{\textbf{\texttt{evframe}}}}
% the next 3 are obsolete.
\newcommand{\execframe}{\mbox{\textbf{\texttt{execframe}}}}
%\newcommand{\evframe}{\mbox{\textbf{\texttt{evframe}}}}
\newcommand{\contframe}{\mbox{\textbf{\texttt{contframe}}}}
\newcommand{\defframe}{\mbox{\textbf{\texttt{defframe}}}}
\newcommand{\Excep}{\mbox{\textit{Excep}}}

\newcommand*{\seq}[1]{\ensuremath{\left\langle {#1} \right\rangle}} % Arg is sequence contents
\newcommand{\config}{\seq}
\newcommand{\udot}{\mathbin{\sqcup \kern-0.53em \cdot \,}}

% Aux functions
\newcommand{\auxFunc}[1]{\ensuremath{\mathop{\mathit{#1}}}}
\newcommand*{\disjointDomains}{\auxFunc{disjointDomains}}
\newcommand*{\override}{\auxFunc{override}}
\newcommand*{\fieldsOf}{\auxFunc{fieldsOf}}
\newcommand*{\envOf}{\auxFunc{envOf}}
\newcommand*{\tenvOf}{\auxFunc{tenvOf}}
%\newcommand*{\callTenvFor}{\auxFunc{callTenvFor}}
\newcommand*{\namesOf}{\auxFunc{namesOf}}
\newcommand*{\handlerBind}{\auxFunc{hbind}}
\newcommand*{\handlerMatch}{\auxFunc{hmatch}}
\newcommand*{\match}{\auxFunc{match}}
%\newcommand*{\matchPCD}{\auxFunc{matchPCD}}
\newcommand*{\matchPCD}{\auxFunc{mpcd}}
\newcommand*{\bindings}{\auxFunc{bindings}}
\newcommand*{\bindingsSearch}{\auxFunc{binds}}
\newcommand*{\methodBody}{\auxFunc{methodBody}}
\newcommand{\concat}{\auxFunc{concat}}
\newcommand{\reverse}{\auxFunc{reverse}}

% Type checking macros
% change symbol type of : from mathrel 
%\DeclareMathSymbol{:}{\mathbin}{operators}{"3A} 
\newcommand{\OK}{\mbox{OK}}
\newcommand{\OKin}{\mbox{OK in }}
\newcommand{\isType}{\mbox{\textit{isType}}}
\newcommand{\isEVType}{\mbox{\textit{isEVType}}}
\newcommand{\isClass}{\mbox{\textit{isClass}}}
\newcommand{\Types}{\mbox{\textit{Types}}}
\newcommand{\Names}{\mbox{\textit{Names}}}
\newcommand{\TypeEnv}{\mbox{\textit{TypeEnv}}}
\newcommand{\VD}{\mbox{\textit{VD}}}
\newcommand{\PCD}{\mbox{\textit{PCD}}}
\newcommand{\pcd}{\mbox{\textit{pcd}}}
\newcommand{\TypesInOrder}{\mbox{\textit{typesInOrder}}}
\newcommand{\dom}{\mbox{\textit{dom}}}
\newcommand{\rng}{\mbox{\textit{rng}}}
\newcommand{\POWERSET}[1]{\mbox{\textit{PowerSet}}(#1)}
\newcommand{\delete}{\mbox{\textit{delete}}}
\newcommand{\mklist}{\mbox{\textit{mksupers}}}
\newcommand{\uminus}{\mbox{$\cup\!\!\!\!-$}}
\newcommand{\iminus}{\mbox{$\cap\!\!\!\!-$}}
\newcommand{\rname}[1]{$\TirName{(#1)}$} % for inline inferrule names
\newcommand{\STO}{\ensuremath{\preccurlyeq}}  % ``subtype of''
\newcommand{\consistent}{\ensuremath{\approx}}
% Type attributes
\newcommand{\Adv}{\mbox{\texttt{\textbf{adv}}~}}
\newcommand{\Aspect}{\mbox{\texttt{\textbf{aspect}}~}}
\newcommand{\Class}{\mbox{\texttt{\textbf{class}}~}}
\newcommand{\Decl}{\mbox{\texttt{\textbf{decl}}~}}
\newcommand{\RDecl}{\mbox{\texttt{\textbf{rdecl}}~}}
\newcommand{\Exp}{\mbox{\texttt{\textbf{exp}}~}}
\newcommand{\Prog}{\mbox{\texttt{\textbf{prog}}~}}
\newcommand{\Interface}{\mbox{\texttt{\textbf{interface}}~}}
\newcommand{\Ifaces}{\mbox{\texttt{\textbf{ifaces}}~}}
\newcommand{\Supers}{\mbox{\texttt{\textbf{supers}}~}}
\newcommand{\EVType}{\mbox{\texttt{\textbf{evtype}}~}}
\newcommand{\Meth}{\mbox{\texttt{\textbf{meth}}~}}
\newcommand{\Pcd}{\mbox{\texttt{\textbf{pcd}}~}}
\newcommand{\Stmt}{\mbox{\texttt{\textbf{stmt}}}}
\newcommand{\Type}{\mbox{\texttt{\textbf{type}}}}
\newcommand{\Var}{\mbox{\texttt{\textbf{var}}~}}
\newcommand{\var}{\mbox{\textit{var}}}
\newcommand{\Nil}{\ensuremath{\bullet}}
% Reserved words (in math mode)
\newcommand{\Extends}{\mbox{\texttt{\textbf{extends}}}}
\newcommand{\Event}{\mbox{\texttt{\textbf{event}}}}
\newcommand{\Implements}{\mbox{\texttt{\textbf{implements}}}}
\newcommand{\This}{\mbox{\texttt{\textbf{this}}}}
\newcommand{\EV}{\mbox{\texttt{\textbf{event}}~}}
\newcommand{\Cast}{\mbox{\texttt{\textbf{cast}}}}
\newcommand{\New}{\mbox{\texttt{\textbf{new}}~}}
\newcommand{\Null}{\mbox{\texttt{\textbf{null}}}}
\newcommand{\Chain}{\mbox{\texttt{\textbf{chain}}~}}
\newcommand{\Under}{\mbox{\texttt{\textbf{under}}~}}
\newcommand{\If}{\mbox{\texttt{\textbf{if}}}}
\newcommand{\Then}{\mbox{\texttt{\textbf{then}}}}
\newcommand{\Else}{\mbox{\texttt{\textbf{else}}}}
\newcommand{\While}{\mbox{\texttt{\textbf{while}}}}
\newcommand{\Around}{\mbox{\texttt{\textbf{around}}}}
\newcommand{\Return}{\mbox{\texttt{\textbf{return}}}}
\newcommand{\Pointcut}{\mbox{\texttt{\textbf{pointcut}}}}
\newcommand{\Proceed}{\mbox{\texttt{\textbf{proceed}}}}
\newcommand{\Delegate}{\mbox{\texttt{\textbf{delegate}}}}
\newcommand{\Register}{\mbox{\texttt{\textbf{register}}}}
\newcommand{\ProceedType}{\mbox{\texttt{\textbf{PType}}}}
\newcommand{\Boolean}{\mbox{\texttt{\textbf{boolean}}}}
\newcommand{\Int}{\mbox{\texttt{\textbf{int}}}}
\newcommand{\Void}{\mbox{\texttt{\textbf{void}}}}
\newcommand{\Cflow}{\mbox{\texttt{\textbf{cflow}}}}

% Other stuff
\def\minimao#1{Mini\-MAO$_{#1}$\xspace}

% Macros for the Figure Editor Example
\newcommand{\FElement}{\mbox{\texttt{FElement}~}}
\newcommand{\ChangedFE}{\mbox{\texttt{changedFE}~}}
\newcommand{\FEChange}{\mbox{\texttt{FEChange}~}}

% A code environment for putting code in figures
\DefineVerbatimEnvironment{figurecodeverbatim}%
  {Verbatim}%
  {fontfamily=tt,%
   fontsize=\small,%
   commandchars=\\\{\},%
   formatcom=\def\{{\symbol{123}}\def\}{\symbol{125}}\def\\{\symbol{92}},%
   listparameters=\setlength{\topsep}{0pt}%
                  \setlength{\partopsep}{0pt}%
                  \setlength{\parskip}{0pt}%
   }

\DefineVerbatimEnvironment{CodeVerbatim}
{Verbatim}{fontsize=\scriptsize,gobble=1,numbers=left,numbersep=2pt,numberblanklines=false}

% An environment for boxed figures
\usepackage{float}
\newenvironment{boxedfigure}
{
\floatstyle{boxed} 
\restylefloat{figure}
\begin{figure}[htb]
\em}
{
\end{figure}
\floatstyle{plain} 
\restylefloat{figure}
}
% Help LaTeX not violate the column margins
\tolerance=50000

\newcommand*{\code}[1]{\texttt{#1}}

% Settings for the listings package
\lstset{language=[AspectJ]Java,basicstyle=\ttfamily,commentstyle=\ttfamily,numbers=left,numberstyle=\tiny,numbersep=2pt,numberblanklines=false,morekeywords={cast,evtype,event,register,loc,chain,under},deletekeywords={proceed}}

% could use \relsize{-2} instead of \scriptsize below
\newcommand{\FIGCODEFONT}{\relsize{-2}\ttfamily}

\newcommand{\LSTAJFILE}[1]{
\lstinputlisting[basicstyle=\FIGCODEFONT]{#1}
}
\newcommand{\LSTAJFILESLICE}[2]{
\lstinputlisting[gobble=4,basicstyle=\FIGCODEFONT,linerange={#1}]{#2}
}

% cross referencing
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\fignref}[1]{Figure~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}
\newcommand{\secnref}[1]{Section~\ref{#1}}

\newcommand{\etal}{~\textit{et al.}}
\newcommand{\kind}{\textit{kind}}
\newcommand{\KIND}{\textit{KIND}}

% Allow figures to take up the entire page
\renewcommand\floatpagefraction{.99}
\renewcommand\topfraction{.99}
\renewcommand\bottomfraction{.90}
\renewcommand\textfraction{.01}

% Gary's theorems environments...
%{theorems}
%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{axiom}[theorem]{Axiom}
%\newtheorem{corollary}[theorem]{Corollary}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{example}[theorem]{Example}
%\newtheorem{fact}[theorem]{Fact}
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{remark}[theorem]{Remark}
%\newtheorem{conjecture}[theorem]{Conjecture}
% Some helpful notation
\newcommand{\PROOF}{{\em Proof:\/}~~}
\newcommand{\PROOFSKETCH}{{\em Proof Sketch:\/}~~}
\newcommand{\QED}{\rule{0.4em}{0.65em}}

\definecolor{light-gray}{gray}{0.75}
